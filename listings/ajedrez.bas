   5 RUN 10
  10 REM * * AJEDREZ * *
  20 POKE 23609,0: POKE 23658,8
  30 BORDER 2: PAPER 6: INK 0: CLS 
  40 GO SUB 7000
  50 GO SUB 6000
1000 REM MOVIMIENTOS DE BLANCAS 
1003 PAUSE 0: IF INKEY$="F" THEN LOAD "M:MENU"
1005 LET A=3: LET B=5: LET C=7: LET D=9: LET E=11: LET F=13: LET G=15: LET H=17
1007 PRINT AT 20,16;NE
1010 INPUT "BLANCA DE:";X;Y
1020 INPUT "BLANCA A:";U;V
1030 GO SUB 3000
1040 PRINT AT X,Y;" ": GO TO 1060
1050 PRINT AT X,Y;"Ⓖ"
1060 PRINT #0;AT 0,0;"PIEZA MOVIDA:": PAUSE 0: LET J$=INKEY$: PRINT #0;AT 0,0;"             "
1070 IF J$="P" THEN PRINT AT U,V;"Ⓗ": GO TO 1130
1080 IF J$="T" THEN PRINT AT U,V;"Ⓘ": GO TO 1130
1090 IF J$="C" THEN PRINT AT U,V;"Ⓚ": GO TO 1130
1100 IF J$="A" THEN PRINT AT U,V;"Ⓙ": GO TO 1130
1110 IF J$="Q" THEN PRINT AT U,V;"Ⓛ": GO TO 1130
1120 IF J$="R" THEN PRINT AT U,V;"Ⓜ": GO TO 1130
1125 GO TO 1060
1130 BEEP .1,30: BEEP .1,35: INPUT "]COME PIEZA? "; LINE K$
1140 IF K$="N" THEN GO TO 1230
1150 IF K$="S" THEN INPUT "CODIGO:"; LINE L$
1160 LET NE=NE+1: PRINT AT 20,16;NE
1170 IF L$="P" THEN PRINT AT 21,7+NE;"Ⓐ"
1180 IF L$="T" THEN PRINT AT 21,7+NE;"Ⓑ"
1190 IF L$="C" THEN PRINT AT 21,7+NE;"Ⓓ"
1200 IF L$="A" THEN PRINT AT 21,7+NE;"Ⓒ"
1210 IF L$="Q" THEN PRINT AT 21,7+NE;"Ⓔ"
1220 IF L$="R" THEN PRINT AT 21,7+NE;"Ⓕ"
1230 INPUT INVERSE 1; FLASH 1;"]PROMOCION DE PEON?"; LINE Q$
1240 IF Q$="N" THEN GO TO 2000
1250 IF Q$="S" THEN GO TO 5000
1260 GO TO 2000
1999 STOP 
2000 REM  MOVIMIENTOS DE NEGRAS 
2003 PAUSE 0: IF INKEY$="F" THEN LOAD "M:MENU"
2005 LET A=3: LET B=5: LET C=7: LET D=9: LET E=11: LET F=13: LET G=15: LET H=17
2010 INPUT "NEGRA DE:";X;Y
2020 INPUT "NEGRA A:";U;V
2030 GO SUB 3500
2040 PRINT AT X,Y;" ": GO TO 2060
2050 PRINT AT X,Y;"Ⓖ"
2060 PRINT #0;AT 0,0;"PIEZA MOVIDA:": PAUSE 0: LET J$=INKEY$: PRINT #0;AT 0,0;"             "
2070 IF J$="P" THEN PRINT AT U,V;"Ⓐ": GO TO 2130
2080 IF J$="T" THEN PRINT AT U,V;"Ⓑ": GO TO 2130
2090 IF J$="C" THEN PRINT AT U,V;"Ⓓ": GO TO 2130
2100 IF J$="A" THEN PRINT AT U,V;"Ⓒ": GO TO 2130
2110 IF J$="Q" THEN PRINT AT U,V;"Ⓔ": GO TO 2130
2120 IF J$="R" THEN PRINT AT U,V;"Ⓕ": GO TO 2130
2125 GO TO 2060
2130 BEEP .1,30: BEEP .1,35: INPUT "]COME PIEZA? "; LINE K$
2140 IF K$="N" THEN GO TO 2230
2150 IF K$="S" THEN INPUT "CODIGO:"; LINE L$
2160 LET BL=BL+1: PRINT AT 1,17;BL
2170 IF L$="P" THEN PRINT AT 0,7+BL;"Ⓗ"
2180 IF L$="T" THEN PRINT AT 0,7+BL;"Ⓘ"
2190 IF L$="C" THEN PRINT AT 0,7+BL;"Ⓚ"
2200 IF L$="A" THEN PRINT AT 0,7+BL;"Ⓙ"
2210 IF L$="Q" THEN PRINT AT 0,7+BL;"Ⓛ"
2220 IF L$="R" THEN PRINT AT 0,7+BL;"Ⓜ"
2230 INPUT INVERSE 1; FLASH 1;"]PROMOCION DE PEON?"; LINE Q$
2240 IF Q$="N" THEN GO TO 1000
2250 IF Q$="S" THEN GO TO 5000
2260 GO TO 1000
2999 STOP 
3000 REM  REPOSICION DEL FONDO 
3010 IF X+Y=A+B OR X+Y=A+D OR X+Y=A+F OR X+Y=A+H THEN GO TO 1050
3020 IF X+Y=B+A OR X+Y=B+C OR X+Y=B+E OR X+Y=B+G THEN GO TO 1050
3030 IF X+Y=C+B OR X+Y=C+D OR X+Y=C+F OR X+Y=C+H THEN GO TO 1050
3040 IF X+Y=D+A OR X+Y=D+C OR X+Y=D+E OR X+Y=D+G THEN GO TO 1050
3050 IF X+Y=E+B OR X+Y=E+D OR X+Y=E+F OR X+Y=E+H THEN GO TO 1050
3060 IF X+Y=F+A OR X+Y=F+C OR X+Y=F+E OR X+Y=F+G THEN GO TO 1050
3070 IF X+Y=G+B OR X+Y=G+D OR X+Y=G+F OR X+Y=G+H THEN GO TO 1050
3080 IF X+Y=H+A OR X+Y=H+C OR X+Y=H+E OR X+Y=H+G THEN GO TO 1050
3499 RETURN 
3500 IF X+Y=A+B OR X+Y=A+D OR X+Y=A+F OR X+Y=A+H THEN GO TO 2050
3510 IF X+Y=B+A OR X+Y=B+C OR X+Y=B+E OR X+Y=B+G THEN GO TO 2050
3520 IF X+Y=C+B OR X+Y=C+D OR X+Y=C+F OR X+Y=C+H THEN GO TO 2050
3530 IF X+Y=D+A OR X+Y=D+C OR X+Y=D+E OR X+Y=D+G THEN GO TO 2050
3540 IF X+Y=E+B OR X+Y=E+D OR X+Y=E+F OR X+Y=E+H THEN GO TO 2050
3550 IF X+Y=F+A OR X+Y=F+C OR X+Y=F+E OR X+Y=F+G THEN GO TO 2050
3560 IF X+Y=G+B OR X+Y=G+D OR X+Y=G+F OR X+Y=G+H THEN GO TO 2050
3570 IF X+Y=H+A OR X+Y=H+C OR X+Y=H+E OR X+Y=H+G THEN GO TO 2050
3999 RETURN 
5000 REM  PROMOCION DE PEONES 
5010 INPUT "PROMUEVE A:"; LINE T$
5020 IF T$="T" THEN GO TO 5250
5030 IF T$="C" THEN GO TO 5200
5040 IF T$="A" THEN GO TO 5150
5050 IF T$="Q" THEN GO TO 5110
5060 GO TO 5010
5110 INPUT "REINA A:";X;Y
5120 INPUT "COLOR DE LA REINA:"; LINE Q$
5130 IF Q$="N" THEN PRINT AT X,Y;"Ⓔ": GO TO 1000
5140 IF Q$="B" THEN PRINT AT X,Y;"Ⓛ": GO TO 2000
5145 GO TO 5120
5150 INPUT "ALFIL A:";X;Y
5160 INPUT "COLOR DEL ALFIL:"; LINE Q$
5170 IF Q$="N" THEN PRINT AT X,Y;"Ⓒ": GO TO 1000
5180 IF Q$="B" THEN PRINT AT X,Y;"Ⓙ": GO TO 2000
5190 GO TO 5160
5200 INPUT "CABALLO A:";X;Y
5210 INPUT "COLOR DEL CABALLO:"; LINE Q$
5220 IF Q$="N" THEN PRINT AT X,Y;"Ⓓ": GO TO 1000
5230 IF Q$="B" THEN PRINT AT X,Y;"Ⓚ": GO TO 2000
5240 GO TO 5210
5250 INPUT "TORRE A:";X;Y
5260 INPUT "COLOR DE LA TORRE:"; LINE Q$
5270 IF Q$="N" THEN PRINT AT X,Y;"Ⓑ": GO TO 1000
5280 IF Q$="B" THEN PRINT AT X,Y;"Ⓘ": GO TO 2000
5290 GO TO 5260
5999 STOP 
6000 REM  DISE\O DE LA PANTALLA 
6010 FOR X=0 TO 128 STEP 16: PLOT X+20,28: DRAW 0,128: NEXT X
6020 FOR X=0 TO 128 STEP 16: PLOT 20,X+28: DRAW 128,0: NEXT X
6030 PRINT AT 19,3;"A B C D E F G H";AT 3,1;"A"''" B"''" C"''" D"''" E"''" F"''" G"''" H"
6040 FOR A=2 TO 14 STEP 2: FOR X=2 TO 14 STEP 2: PLOT 20+A,28+X: PLOT 52+A,28+X: PLOT 84+A,28+X: PLOT 116+A,28+X: NEXT X: NEXT A
6050 FOR A=2 TO 14 STEP 2: FOR X=18 TO 30 STEP 2: PLOT 36+A,28+X: PLOT 68+A,28+X: PLOT 100+A,28+X: PLOT 132+A,28+X: NEXT X: NEXT A
6060 FOR A=2 TO 14 STEP 2: FOR X=34 TO 46 STEP 2: PLOT 20+A,28+X: PLOT 52+A,28+X: PLOT 84+A,28+X: PLOT 116+A,28+X: NEXT X: NEXT A
6070 FOR A=2 TO 14 STEP 2: FOR X=50 TO 62 STEP 2: PLOT 36+A,28+X: PLOT 68+A,28+X: PLOT 100+A,28+X: PLOT 132+A,28+X: NEXT X: NEXT A
6080 FOR A=2 TO 14 STEP 2: FOR X=66 TO 78 STEP 2: PLOT 20+A,28+X: PLOT 52+A,28+X: PLOT 84+A,28+X: PLOT 116+A,28+X: NEXT X: NEXT A
6090 FOR A=2 TO 14 STEP 2: FOR X=82 TO 94 STEP 2: PLOT 36+A,28+X: PLOT 68+A,28+X: PLOT 100+A,28+X: PLOT 132+A,28+X: NEXT X: NEXT A
6100 FOR A=2 TO 14 STEP 2: FOR X=98 TO 110 STEP 2: PLOT 20+A,28+X: PLOT 52+A,28+X: PLOT 84+A,28+X: PLOT 116+A,28+X: NEXT X: NEXT A
6110 FOR A=2 TO 14 STEP 2: FOR X=114 TO 126 STEP 2: PLOT 36+A,28+X: PLOT 68+A,28+X: PLOT 100+A,28+X: PLOT 132+A,28+X: NEXT X: NEXT A
6120 PRINT INK 1;AT 1,20;"*********"; INVERSE 1;AT 2,20;" AJEDREZ "; INVERSE 0;AT 3,20;"*********"
6130 PRINT INK 0;AT 5,20;"INTRODUCIR";AT 6,20;"LETR. LAT.";AT 7,20;"Y LET.INF.";AT 8,20;"SEPARADAS.";AT 9,20;"*********"
6140 PRINT INK 1;AT 10,20;"CODIGO:"
6150 PRINT AT 11,20;"PEON------P";AT 12,20;"TORRE-----T";AT 13,20;"CABALLO---C";AT 14,20;"ALFIL-----A";AT 15,20;"REINA-----Q";AT 16,20;"REY-------R"
6160 PRINT AT 17,3;"Ⓘ";AT 17,5;"Ⓚ";AT 17,7;"Ⓙ";AT 17,9;"Ⓛ";AT 17,11;"Ⓜ";AT 17,13;"Ⓙ";AT 17,15;"Ⓚ";AT 17,17;"Ⓘ"
6170 FOR N=3 TO 17 STEP 2: PRINT AT 15,N;"Ⓗ";AT 5,N;"Ⓐ": NEXT N
6190 PRINT AT 3,3;"Ⓑ";AT 3,5;"Ⓓ";AT 3,7;"Ⓒ";AT 3,9;"Ⓔ";AT 3,11;"Ⓕ";AT 3,13;"Ⓒ";AT 3,15;"Ⓓ";AT 3,17;"Ⓑ"
6200 LET BL=0: LET NE=0
6210 PRINT AT 1,1;"BLANCAS COMIDAS:";BL;AT 20,1;"NEGRAS COMIDAS:";NE
6999 RETURN 
7000 REM  CARACTERES GRAFICOS 
7010 FOR X=0 TO 12: FOR Y=0 TO 7: READ Z: POKE USR CHR$ (144+X)+Y,Z: NEXT Y: NEXT X
7020 DATA 0,0,24,60,60,24,60,126,0,85,127,62,62,62,127,127,0,24,52,110,126,60,126,126
7030 DATA 0,12,62,126,14,28,62,127,24,36,163,90,189,126,126,126,24,126,219,219,90,126,126,126
7040 DATA 0,170,0,170,0,170,0,170
7050 DATA 0,0,24,36,36,24,36,126,0,85,127,34,34,34,99,127,0,24,44,82,66,36,102,126
7060 DATA 0,12,50,114,10,20,34,127,24,36,170,90,189,102,90,126,24,126,153,153,90,126,90,126
7999 RETURN 
9999 SAVE "M:AJEDREZ" LINE 0: PRINT AT 1,0: LOAD ""
